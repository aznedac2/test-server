(window.zwstdWebpackLoader=window.zwstdWebpackLoader||[]).push([[15],{146:function(t,e,i){"use strict";(function(o){var d;void 0===(d=function(t){var e=i(1),o=i(7),d=i(391),n=i(69),r=i(475),a=i(135),c=i(408),s=i(34),u=i(71),l=i(829),p=i(362),h=i(833),g=i(477),m=i(875),f=i(478),S=i(415),C=i(363),_=i(465),b=i(431),P=i(426),k=i(464),y=i(479),v=i(44);return n.extend({name:"BundleDetailController",dataKeys:["product","category","mobileApp","parentId"],domEvents:{"mouseup focus contextmenu|._item-navigation-link":"_updateLink"},preInit:function(){this.data.product=new d(this.data.product),this.props.shouldLoadRelatedProducts=this.data.product.detail.relatedProducts&&!!this.data.product.detail.relatedProducts.length},_updateLink:function(t){var i=e(t.target).closest("._item-navigation-link");P.updateProductLink(i)},_getSelectedColor:function(){return this.data.product.detail.colors[0].id},_initProductImpressionsWidget:function(){this.productImpressionsWidget=this.createWidget(_,this.$mainEl,{selector:{image:"._catentry-buying-summary-img",fixedEl:"._fixed:not(._navMenuWrapper)"},callback:function(t){var e,i,o,n=t.closest("._secondary-product, ._catentry-buying-summary-img"),r=this.data.product.detail.bundleProducts,a="BUNDLE_COMPONENT",c=n.data("id");for(n.parents("._related-products").length&&(r=this.props.relatedProducts,a="CROSS_SELLING"),o=0;o<r.length;o++)if(i=r[o].id,parseInt(i,10)===parseInt(c,10))return{selectedColorId:(e=new d(r[o])).detail.colors[0].id,listType:a,product:e,position:o}}.bind(this)})},_notifyClickOnRelatedProduct:function(t,e){c.notifyProductClick(t,{category:this.data.category,clickSource:{productRef:this.data.product.detail.reference,colorCode:this._getSelectedColor(),listType:"CROSS_SELLING",pos:e}})},_loadRelatedProducts:function(){var t,i,d=this,n=e("._related-products");t=-1!==s.location.href.indexOf(this.data.parentId),this.data.product.seo&&this.data.product.seo.seoProductId&&(t=t||-1!==s.location.href.indexOf(this.data.product.seo.seoProductId)),o.store.isOpenForSale&&t&&this.props.shouldLoadRelatedProducts&&(this.data.product.parentId=this.data.parentId,i=this.data.product.detail.colors[0].id,p.getInternalRelatedProducts(this.data.product,i,(function(t){l.initRelatedProducts({wrapper:n,controller:d,products:t}),d.props.relatedProducts=t,a.isSizeRecommenderEnabled()&&a.init(t.concat(d.data.product))})))},onScrollLimitReached:function(){this._loadRelatedProducts()},registerSetComponentsClick:function(){var t=this;this.$mainEl.find("._set-component ._item-navigation-link").off("click").on("click",(function(i){var o=e(i.currentTarget).closest("._set-component").index(),n=t.data.product.detail.bundleProducts[o];c.notifyProductClick(d.findProductInProduct(t.data.product,n.id),{category:t.data.category,clickSource:{productRef:t.data.product.detail.reference,colorCode:t.data.product.detail.colors[0].id,listType:"BUNDLE_COMPONENT",pos:o}})}))},configureSet:function(){var t,e=this.$mainEl.find("._items-carousel-container");this.priceWidget=this.createWidget(k,this.$mainEl.find("._bundle-price"),{product:this.data.product,showUnitPrice:!0}),t=this.priceWidget.updatePriceByColorAndSize(),v.setCustomAttribute("mainPrice",u.formatMoneySem(t)),this.data.product.detail.bundleProducts.length>5?this.createWidget(b,e,{visibleItems:{"min-width: 0px":5},margin:16,onCarouselLoaded:function(){e.removeClass("loading")}}):e.addClass("static").removeClass("loading"),this.registerSetComponentsClick()},init:function(){var t=this,i=this.$mainEl.find("._miniContact"),o=this.$mainEl.find("._shareContainer");r.config({msg:this.data.mobileApp.msg,iOSUri:this.data.mobileApp.iOSUri,androidUri:this.data.mobileApp.androidUri}).showDialog(),this.createWidget(h,this.$mainEl.find("._products-nav"),{product:this.data.product,parentId:this.data.parentId,categoryId:this.data.category.id}),this.data.product.isSet&&this.configureSet(),this.actionsWidget=this.createWidget(m,this.$mainEl.find("._bundle-detail-actions"),{product:this.data.product,category:this.data.category}),i.length>0&&this.createWidget(S,i,{product:this.data.product,originalContext:"product-detail"}),o.length>0&&this.createWidget(C,o,{product:this.data.product,url:window.location.href,getColorCode:this._getSelectedColor.bind(this),origin:"product-sharing"}),this.imagesWidget=this.createWidget(g,this.$mainEl.find("._product-images-section"),{product:this.data.product,onScrollLimitReached:e.proxy(this.onScrollLimitReached,this),manageSingle:!0}),this.initialDetailMenuWidget=this.createWidget(f,this.$mainEl,{$limit:this.$mainEl.find("._bundle-others-section"),onImagesLoaded:function(){t._initProductImpressionsWidget(),setTimeout((function(){return t.productImpressionsWidget.notifyImpressions()}),400)}}),this.infoWidget=this.createWidget(y,this.$mainEl.find("._product-info"),{product:this.data.product})}})}.call(e,i,e,t))||(t.exports=d)}).call(this,i(1))},875:function(t,e,i){"use strict";(function(o){var d;void 0===(d=function(t){var e=i(1),o=i(7),d=i(18),n=i(426),r=i(408),a=i(476),c=i(876),s=i(831),u=i(135),l=i(391);return d.extend({name:"BundleDetailActionsWidget",domEvents:{"click focus contextmenu|._product-popup-link":"updateLink","click|._bundle-component-link":"_onComponentClicked","change|._bundleComponentSelectorCheck":"_onCheckBoxClicked","click|._bundleComponentSelectorCheck":"_preventClick","click|._bundleComponentSelectorLabel":"_preventClick"},_preventClick:function(t){t.stopPropagation()},_getCheckBox:function(t){return this.$mainEl.find('._bundleComponentSelectorCheck[data-id="'.concat(t,'"]'))},getSizeSelectorWidget:function(t){return this.props.productsSizeSelectorMap[t]},_onComponentClicked:function(t){if(o.store.isOpenForSale){t.preventDefault(),t.stopPropagation();var i=e(t.currentTarget).find("._catentry-buying-summary-img").data("id");this._getCheckBox(i).click()}},_onCheckBoxClicked:function(t){var i=e(t.target);this._updateCartInfo(i)},_getSizeSelectorBottom:function(t){var e=t.getSizeSelectElement();return e[0].getBoundingClientRect().top+e.outerHeight(!0)},_posComponent:function(t){var i=this;if(!Modernizr.touch){var o=e(window),d=this._getSizeSelectorBottom(this.getSizeSelectorWidget(t))+this.bundleCartInfoWidget.getElementHeight()-o.height(),n=Math.ceil(Math.max(d,this.$mainEl.position().top)),r=o.scrollTop()+n;0===n||r<0||(this.$mainEl.one("transitionend webkitTransitionEnd oTransitionEnd",(function(){i.$mainEl.removeClass("animated")})),this.$mainEl.addClass("animated"),o.scrollTop(r))}},_onSizeSelectorOpened:function(t){var e=this._getCheckBox(t);e.is(":checked")||(e.prop("checked",!0),this._updateCartInfo(e)),this._posComponent(t)},_unselectAllComponents:function(){var t=this;this.props.bundleComponents.forEach((function(e){t._unselectComponent(e.id,!0)}))},_unselectComponent:function(t,e){var i=this._getCheckBox(t),o=this.getSizeSelectorWidget(t),d=o&&o.getSelectedSize();!i.is(":checked")||d&&!e||(i.prop("checked",!1),this.props.addToCartActionWidget&&this.props.addToCartActionWidget.removeProduct(t),this.bundleCartInfoWidget.onProductDeselected(t))},_onSizeSelected:function(t){var e=this._getCheckBox(t),i=this.props.bundleComponents.filter((function(e){return e.id===t}))[0],o=this.getSizeSelectorWidget(t),d=o&&o.getSelectedSize(),n=d&&d.price;n&&(e.prop("checked",!0),this.props.addToCartActionWidget&&this.props.addToCartActionWidget.addProduct(i,o,u),this.bundleCartInfoWidget.onProductSelected(t,n))},_updateCartInfo:function(t){var e=parseInt(t.data("id"),10),i=this.props.bundleComponents.filter((function(t){return t.id===e}))[0],o=this.getSizeSelectorWidget(e),d=o&&o.getSelectedSize(),n=d&&d.price||i.getMainPrice();t.is(":checked")?(d?o.closeOtherPanels():o.openSizeSelector(),this.props.addToCartActionWidget&&this.props.addToCartActionWidget.addProduct(i,o,u),this.bundleCartInfoWidget.onProductSelected(e,n)):(o.closeAllPanels(),this.props.addToCartActionWidget&&this.props.addToCartActionWidget.removeProduct(e),this.bundleCartInfoWidget.onProductDeselected(e))},onProductsAdded:function(t){var e=this,i=t[0].quantity,o=this.data.product.isSet?this.data.product.detail.bundleProducts.map((function(t,e){return{product:t,position:e}})):t.reduce((function(t,i){var o,d=e.props.bundleComponents.find((function(t,e){return o=e,i.product.id===t.id}));return t.push({product:d,position:o,recommendedSize:i.recommendedSize,selectedSize:i.selectedSize,sizeSuggester:i.sizeSuggester}),t}),[]);r.notifyProductsAddedToCart(this.data.product,{quantity:this.data.product.isSet&&i,category:this.data.category,sendBundleProducts:!0,products:o}),this._unselectAllComponents()},updateLink:function(t){var i=e(t.target).closest("._product-popup-link");n.updateProductLink(i)},_onCatentrySummarySelected:function(t){var e=0;this.data.product.detail.bundleProducts.forEach((function(i,o){i.detail.reference!==t.detail.reference||(e=o)})),r.notifyProductClick(t,{category:this.data.category,clickSource:{productRef:this.data.product.detail.reference,colorCode:this.data.product.detail.colors[0].id,listType:"BUNDLE_COMPONENT",pos:e}})},_addFromSizeSuggester:function(){this.props.addToCartActionWidget&&this.props.addToCartActionWidget.addRecommendedSize()},init:function(){var t=this;this.props.bundleComponents=[],this.props.productsSizeSelectorMap={},this.data.product.isSet?this.createWidget(s,this.$mainEl.find("._cart-actions"),{product:this.data.product,category:this.data.category,options:{showAddingFeedback:!0,amountSelector:!0},onProductsAdded:function(e){return t.onProductsAdded(e)}}):(this.data.product.detail.bundleProducts.forEach((function(e,i){e=l.findProductInProduct(t.data.product,e.id),t.props.bundleComponents.push(e);var o=t.createWidget(a,t.$mainEl.find("._component-"+e.id),{product:e,bundleProductId:t.data.product.id,category:t.data.category,position:i,relProducts:t.data.product.detail.relatedProducts,onCatentrySummarySelected:t._onCatentrySummarySelected.bind(t),onSizeSelected:t._onSizeSelected.bind(t),onSizeSelectorOpened:t._onSizeSelectorOpened.bind(t),onSizeSelectorClosed:t._unselectComponent.bind(t),addFromSizeSuggester:t._addFromSizeSuggester.bind(t)});t.props.productsSizeSelectorMap[e.id]=o.getSizeSelectorWidget()})),u.isSizeRecommenderEnabled()&&u.init(this.props.bundleComponents),this.props.addToCartActionWidget=this.createWidget(s,this.$mainEl.find("._cart-actions"),{product:this.data.product,category:this.data.category,options:{showAddingFeedback:!0},onProductsAdded:function(e){return t.onProductsAdded(e)}}),this.bundleCartInfoWidget=this.createWidget(c,this.$mainEl.find("._cartInfo"),{$bundleTotal:this.$mainEl.find("._bundleTotal"),$bundleNumItems:this.$mainEl.find("._bundleItems")}))}})}.call(e,i,e,t))||(t.exports=d)}).call(this,i(1))},876:function(t,e,i){"use strict";var o;void 0===(o=function(t){var e=i(18),o=i(71),d=i(19);return e.extend({name:"BundleCartInfoWidget",updateUI:function(){var t,e=this,i=Object.keys(this.props.bundleItems),n=i.length,r=i.reduce((function(t,i){return t+e.props.bundleItems[i]}),0);t=1===n?d.getText("shop.shop-cart","item"):d.getText("shop.shop-cart","items"),this.data.$bundleTotal.html(o.formatMoney(r)),0===r?(this.data.$bundleTotal.addClass("hidden"),this.data.$bundleNumItems.addClass("hidden")):(this.data.$bundleTotal.removeClass("hidden"),this.data.$bundleNumItems.removeClass("hidden")),this.data.$bundleNumItems.html("".concat(n," ").concat(t))},onProductSelected:function(t,e){this.props.bundleItems[t]=e,this.updateUI()},onProductDeselected:function(t){delete this.props.bundleItems[t],this.updateUI()},getElementHeight:function(){return this.$mainEl.outerHeight(!0)},init:function(){this.props.bundleTotal=0,this.props.bundleNumItems=0,this.props.bundleItems={}}})}.call(e,i,e,t))||(t.exports=o)}}]);